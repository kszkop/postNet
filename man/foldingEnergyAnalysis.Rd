% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/foldingEnergyAnalysis.R
\name{foldingEnergyAnalysis}
\alias{foldingEnergyAnalysis}
\title{ Calculation of folding energy}

\usage{
foldingEnergyAnalysis(a2sU, sourceFE = "load",fromFasta = FALSE, customFileFE = NULL, residFE = TRUE, region=NULL, comparisons=NULL, plotOut = TRUE, pdfName = NULL )
}

\arguments{
\item{a2sU}{ anota2seqUtils class object created using anota2seqUtilsStart function }
\item{sourceFE}{ selecting the source of the folding energy calculations. If "load", it will use precalculated folding energies for selected species ("human" and "mouse" available at the moment). However, there is an option to automatically calculate new ("create") based on the selection of regions or fromFasta ( fasta file with sequences and transcript ids as names) or load custom 'custom' file with precalculated folding energies calculations in the format: transcript ID, folding energy, length of the sequence. The default is "load". }
\item{fromFasta}{ If TRUE, it will calculate folding energy values with mfold using a custom fasta file. The default is FALSE. }
\item{customFileFE}{ Name of a file including a path to the customFile. It is required for sourceFE=='custom' or if sourceFE=='create' and fromFasta==TRUE. In the former case, it must be the file with calculated folding energies in the format: transcript ID, folding energy, length of the sequence, or in the latter fasta files with sequences and transcript ids as names. }
\item{residFE}{ Residuals after correction for the length of the sequences should be used instead. The default is TRUE.}
\item{region}{ Select the regions of interest. Choose from combination of "UTR5", "CDS", "UTR3" }
\item{comparisons}{ Indicate which regulation/geneList pairs should be compared. It should be provided as a list of vectors with pairs of indexes in regulation/geneList (for example list(c(0,2),c(2,4)) would indicate that the background (0) would be compared to the second and the second to the fourth mode of regulation/geneList. If both regulation and geneList are provided, geneList is appended to the end. }
\item{plotOut}{ Logical whether plots and optionally comparisons should be performed. The default is TRUE. }
\item{plotType}{ If plotOut is TRUE, please indicate the type of the output plots (Choose from "boxplot", "violin", "ecdf"). The default is "ecdf". }
\item{pdfName}{ Name of the output pdf files. }
}

\value{
Vector with calculated folding energy values for each gene. The function will also output plots with desired comparisons.
}

\description{
Calculation of folding energy is performed. mfold algorithm is used for calculations (if the function is used for calulcuating folding energies (sourceFE = "create"), it requires installed mfold with executables in the path). Mfold can be run from provided a fasta file or from prepared by anota2seqUtilsStart function. As the process of calculating folding energy is very long (even weeks for a large number of long sequences), it is also possible just to use already precalculated values for available reference sequences (available for mouse and human). Furthermore, differences in folding energy between selected modes of regulation can be also assessed and plotted.
}

\details{
The function uses mfold algorithm for folding energy calculations (https://bio.tools/mfold).
# Citation
M. Zuker. Mfold web server for nucleic acid folding and hybridization prediction. Nucleic Acids Res. 31 (13), 3406-3415, 2003. https://doi.org/10.1093/nar/gkg595
}


\examples{
#First prepare anota2seqUtils class object
# from anota2seq object
a2sU <- anota2seqUtilsStart(ads = anota2seqOutput, regulation =  c("translationUp","translationDown"), contrast = c(1,1), regulationGen = "translation", contrastSel = 1, region = c("UTR5"), selection ="random", source = 'load', species = 'human')
# or from geneList
a2sU <- anota2seqUtilsStart(geneList = inList, geneListcolours=c("#F2A104","#00743F"), effectMeasure = quantIn, region = c("UTR5"), selection ="random", comparisons = list(c(0,1),c(0,2),c(1,2)),plotType = "boxplot")

feOut <- foldingEnergyAnalysis(a2sU = a2sU, sourceFE = "load", residFE = TRUE, region = c("UTR5","CDS","UTR3"),comparisons = list(c(1,2)),plotOut = TRUE, pdfName = NULL )

#If only calculating folding energies
foldingEnergyAnalysis(a2sU = a2sU, sourceFE = "create", region = c("UTR5"))
}
