% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postNetStart.R
\name{postNetStart}
\alias{postNetStart}
\title{Preparation of annotation and inputs}
\usage{
postNetStart(ads = NULL, regulation = NULL, contrast = NULL, regulationGen = NULL, contrastSel = NULL, geneList = NULL, geneListcolours = NULL, customBg = NULL, effectMeasure=NULL, selection = "random", source, version = NULL, species = NULL, customFile = NULL, fastaFile = NULL, posFile = NULL, rna_gbff_file = NULL, rna_fa_file = NULL, genomic_gff_file = NULL,adjObj = NULL,region_adj = NULL,excl = FALSE, keepAll = FALSE)
}

\arguments{
\item{ads}{ An anota2seq object (an S4 object that is the output of the anota2seqRun function from the anota2seq package. See the anota2seq vignette for details). }
\item{regulation}{ If an anota2seq object is provided, provide the names of the regulatory modes that are to be compared as a vector. The possible choices are: "translationUp", "translationDown", "translatedmRNAUp", "translatedmRNADown", "bufferingmRNAUp", "bufferingmRNADown", "mRNAAbundanceUp", "mRNAAbundanceDown", "totalmRNAUp", "totalmRNADown". See the anota2seq vignette for additional details on regulatory modes. }
\item{contrast}{ If an anota2seq object is provided, select the respective contrasts in the anota2seq object for each selected regulation mode provided for 'regulation'. This must be a numeric vector of the same length as the input for 'regulation'. For example, c(1,1,2) would select the first two modes of regulation provided from contrast 1 and the third from contrast 2). See the anota2seq vignette for additional details on contasts. }
\item{regulationGen}{ Desired name of regulation from the anota2seq. Choose from "translation", "buffering", "mRNAAbundance", "translatedmRNA", "totalmRNA" to extract effectMeasure from the anota2seq object.}
\item{contrastSel}{ contrast for mode of regulation in the anota2seq object to be analysed }
\item{geneList}{ Instead of the anota2seq object, selected genes of interest can be provided in form of a named list of vectors. }
\item{geneListcolours}{ If geneList is provided, please provide colours for each gene selection }
\item{customBg}{ There is an option to provide a custom set of background genes as a character vector. }
\item{effectMeasure}{ In case the anots2seq object is absent, own measure of changes.}
\item{selection}{ There are multiple isoforms for a given gene, In this option, it is decided which isoform is selected to represent the gene, whether the longest or the shortest for a given region will be taken into consideration or simply random one.  Choose from  "longest", "shortest", or "random". The default is "random". }
\item{source}{Select the source of the reference sequences. There are five options to choose from: 'load' (default), 'custom', 'create', 'createFromFasta', and 'createFromSourceFiles'. The default option 'load' involves using pre-existing versions. However, you can also prepare references based on the latest version of NCBI RefSeq by selecting the 'create' option, which will automatically download the required files from the database. If you encounter issues with automatic downloads or do not have an internet connection, choose 'createFromSourceFiles' and download the required files separately (i.e., rna_gbff_file, rna_fa_file, and genomic_gff_file). Additionally, 'createFromFasta' allows you to use a custom fastaFile with reference sequences and a posFile in the format: transcriptID, utr5_stop, cds_stop, total_length. Optionally, a genomic.gff file can also be provided along with the fastaFile and posFile using the genomic_gff_file argument. However, if none is provided the most current genomic.gff version will automatically be downloaded from NCBI RefSeq. All these options are currently available only for the 'human' or 'mouse' species. Lastly, the 'custom' option lets you use a pre-prepared file, avoiding the use of the NCBI RefSeq database, or allowing other species to be examined. The customFile must be in the format transcriptID, geneID, UTR5_seq, CDS_seq, UTR3_seq.}
\item{version}{Specify which pre-prepared NCBI RefSeq releases to load. You can use the function checkAvailableVersions to check available versions for a given species. If left as NULL, the function will automatically search for the most recent version.}
\item{species}{Select the species of interest. This argument is required unless the source option is 'custom'. Currently, only 'human' and 'mouse' are supported.}
\item{customFile}{Name and file path to the customFile. The customFile must be a TAB deliminated annotation file with the headings: transcriptID, geneID, UTR5_seq, CDS_seq, UTR3_seq. This argument is only required if the source is 'custom'.}
\item{fastaFile}{Name of a file, including the path to the fastaFile with reference sequences. This argument is only required if the source is 'createFromFasta'.}
\item{posFile}{Name of a file, including the path to the posFile. The file must be in the format: transcriptID, utr5_stop, cds_stop, total_length. This argument is only required if the source is 'createFromFasta'.}
\item{rna_gbff_file}{Name and file path to the rna_gbff_file. This reference file can can be downloaded from NCBI RefSeq. Note that the file should be compressed with gzip (.gz extension), which is the default format for NCBI RefSeq downloads. This argument is only required if the source is 'createFromSourceFiles'.}
\item{rna_fa_file}{Name and file path to the rna_fa_file. This reference file can can be downloaded from NCBI RefSeq. Note that the file should be compressed with gzip (.gz extension), which is the default format for NCBI RefSeq downloads. This argument is only required if the source is 'createFromSourceFiles'.}
\item{genomic_gff_file}{Name and file path to the genomic_gff_file. This reference file can can be downloaded from NCBI RefSeq. Note that the file should be compressed with gzip (.gz extension), which is the default format for NCBI RefSeq downloads. This argument is only required if the source is 'createFromSourceFiles'.}
\item{adjObj}{ It should be a names list for UTR5 and/or UTR3 of named vector of sequences (with transcripts ids as names)}
\item{region_adj}{ UTR to be adjusted: UTR5 and/or UTR3 }
\item{excl}{ When providing custom UTR sequences with 'adjObj', sequences may not be available for all genes/isoforms included in the annotation file. This opption determines whether to keep all genes/isoforms, or discard those that are not included in the custom UTR sequences. If TRUE, any transcript IDs present in the annotation file that are not present in the custom file will be removed, so all entries in the final annotation will reflect the transcripts IDs in the custom sequences provided in 'adjObj'. If FALSE, then the UTR sequences in the annotation file will be replaced with the custom sequences when available, but for transcript IDs where a custom sequence is not available, the original sequence present in the annotation file will be retained and used in the analysis. The default is FALSE. }
\item{keepAll}{ When excl = F, the 'keepAll' argument determines how custom UTR sequences are integrated into the annotation file for genes with multiple isoforms. If TRUE, the UTR sequences in the annotation file will be replaced with the custom sequences corresponding to the same transcript IDs. However, if there are multiple transcript IDs (isoforms) for the same gene ID, all isoforms will be retained, including transcript IDs where custom sequences were not available in 'adjObj'. Note that unless the custom sequences are the longest or shortest isoforms that can be selected using the 'selection' argument, when keepAll is TRUE, the custom sequences are not guaranteed to be the ones considered if a gene-level analysis is performed. If FALSE, transcript IDs (isoforms) corresponding to the same gene that are not found in the custom sequences provided in 'adjObj' will be removed such that only custom UTR sequences will be available for genes with multiple isoforms. For example, this option is useful when the most abundant isoform in a given cell type is known, or for experimentally determined UTR sequences that are condition-specific. The default is FALSE. }
}

\value{
S4 class object with information about selected species and version of the refseq annotation retrieved. The object also contain all the required gene selection inputs.
}

\description{
The `postNetStart` function is used to retrieve and format reference sequences, a crucial step in the postNet analysis. It relies on the NCBI RefSeq database for reference sequence information, but it also offers a custom option to use with any database for any species. The function prepares annotation in the format, transcriptID, geneID and sequence for each region 5'UTR, CDS, and 3'UTR sequences. Quite often there is much more precise information about 5" and 3" UTRs available. There is an option to replace UTR sequences in an annotation with reference sequences with the ones provided by the user in adjObj for available transcripts. In addition, the S4 object is created that is used for all the downstream analysis.
}

\examples{
# Optionally, check available versions for the 'human' species
checkAvailableVersions(species = 'human')

# If desire to adjust UTR sequences
adjUTR5 <- c('AAAA','GGGG')
names(adjUTR5) <- c('NM_000014','NM_000016')

adjUTR3 <-c("ACTGGGG","GGACTT","TTAACCCC")
names(adjUTR3) <- c("NM_000014","NM_000015","NM_000016")

adjObj <- list()
adjObj[['UTR5']] <- adjUTR5
adjObj[['UTR3']] <- adjUTR3

# For anota2seq object
ptn <- postNetStart(ads = anota2seqOutput, regulation =  c("translationUp","translationDown"), contrast = c(1,1), regulationGen = "translation", contrastSel = 1, region = c("UTR5","CDS","UTR3"), selection ="random", source = 'load', species = 'human')

# For geneList
ptn <- postNetStart(geneList = inList, geneListcolours=c("#F2A104","#00743F"), effectMeasure = quantIn, region = c("UTR5","CDS","UTR3"), selection ="random", source = 'load', species = 'human')
}



