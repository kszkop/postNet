% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/codonUsage.R
\name{codonUsage}
\alias{codonUsage}
\title{ Codon usage analysis }

\usage{
codonUsage(annotType = "ccds", annot=NULL, sourceSeq = "load", customFileCod = NULL, species = NULL, analysis="codon", codonN = 1, type = "sequence", dpn_path = NULL, pAdj = 0.01, plotHeatmap = TRUE, thresX1 = 0.3, thresY1 = 0.3, thresX2 = 0.3, thresY2 = 0.3, ads = NULL, regulation = NULL, contrast = NULL, geneList = NULL, customBg = NULL, selection = "random", subregion=NULL, subregionSel=NULL, comparisons=NULL, pdfName = NULL )
}

\arguments{
\item{annotType}{ select source of reference coding region sequences. Choose from "ccds", "custom", "refseq". The default is "ccds". }
\item{annot}{ if annotType is "refseq". An object containing reference sequences is obtained by the retrieveFormatData function. It is data.frame in format: id, geneID, UTR5_seq, CDS_seq, UTR3_seq }
\item{sourceSeq}{ if annotType is "ccds", choose "create" to automatically prepare reference sequences from ccds database,  "load" to load preprepared sequences for selected species, or "custom" to use customFile. The default is "load". }
\item{customFileCod}{ name of a file including a path to the customFile. The customFile has to be in the format transcriptID, geneID, UTR5_seq, CDS_seq, UTR3_seq. It is only required if the annotType is 'custom'. }
\item{species}{ it is required if annotType == 'create' or 'load'. At the moment only human and mouse are available. }
\item{analysis}{ select type of the analysis. Choose from "codon" or alternatively amino acid level "AA". The default is "codon". }
\item{codonN}{ n number of codon combinations. The default is 1. For di-codon choose 2 and so on. The option is available only for type=="sequence". }
\item{type}{ codons calculations are performed using sequences if "sequence" (default). However, there is an option to use ribosomal footprint positions by selecting "riboSeq". Please refer to the section about ribosomal profiling analysis for details.  }
\item{dpn_path}{ path to the dpn files obtained using the riboUtils function. It is required only if type = "riboseq". }
\item{pAdj}{ adjusted p-value threshold for chi-square test. The default is 0.01 }
\item{plotHeatmap}{ option to plot heatmap. The default is TRUE. }
\item{thresX1}{ select the top percentage threshold for odds ratio for selecting codons in up set. The default 0.3 indicates that 30\% of codons with highest odds ratio is selected. It is combined the thresY1 to select the most frequent codons with the highest odds ratio. }
\item{thresY1}{ select the top percentage threshold for frequency for selecting codons in the up set. The default 0.3 indicates that 30\% of the most frequent codons are selected. It is combined the thresX1 to select the most frequent codons with the highest odds ratio. }
\item{thresX2}{ select the top percentage threshold for odds ratio for selecting codons in down set. The default 0.3 indicates that 30\% of codons with lowest odds ratio is selected. It is combined the thresY2 to select the most frequent codons with the lowest odds ratio. }
\item{thresY2}{ select the top percentage threshold for frequency for selecting codons in the down set. The default 0.3 indicates that 30\% of the most frequent codons are selected. It is combined the thresX2 to select the most frequent codons with the lowest odds ratio. }
\item{ads}{ An anota2seq object (an output of anota2seqRun function from anota2seq package) }
\item{regulation}{ If the anota2seq object is provided, desired names of regulation modes from the anota2seq object are to be compared. To choose from "translationUp", "translationDown", "translatedmRNAUp", "translatedmRNAUp", "bufferingmRNAUp", "bufferingmRNADown", "mRNAAbundanceUp", "mRNAAbundanceDown", "totalmRNAUp", "totalmRNADown". }
\item{contrast}{ If the anota2seq object is provided and regulation modes selected, an indication of respective contrasts in the anota2seq object for each selected regulation mode (for example c(1,1,2) would indicate that the first two modes of regulation provided above are from contrast 1 and the third one from contrast 2). }
\item{geneList}{ In addition or instead of the anota2seq object, selected genes of interest can be provided in form of a named list of vectors. }
\item{customBg}{ There is an option to provide a custom set of background genes as a character vector. }
\item{selection}{ There are multiple isoforms for a given gene, In this option, it is decided which isoform is selected to represent the gene, whether the longest or the shortest for a given region will be taken into consideration or simply random one.  Choose from  "longest", "shortest", or "random". The default is "random". }
\item{subregion}{ Optionally it is possible to select a subregion by indicating a number of nucleotides from the start if positive or end if negative. }
\item{subregionSel}{ It is required if the subregion is provided. Choose whether the indicated subregion should be "select" or "exclude". }
\item{InputTable} {Dataframe containing names of dpn files in the first column, condition in numeric format in the second column.}
\item{comparisons}{ Indicate which regulation/geneList pairs should be compared. It should be provided as a list of vectors with pairs of indexes in regulation/geneList (for example list(c(0,2),c(2,4)) would indicate that the background (0) would be compared to the second and the second to the fourth mode of regulation/geneList. If both regulation and geneList are provided, geneList is appended to the end. }
\item{pdfName}{ Name of the output pdf files. }
}

\value{
List with selected codons in up and down sets for each desired comparison. In addition, summary codons calculation (list entry: codonAll) is also provided. The function will also output plots for desired comparisons.
}

\description{
Codon (or alternatively AA) usage analysis is performed. Firstly, for each comparison, the chi-square test is applied. Then, for significant codons, the odds ratio for each desired comparison pair is calculated and plotted against frequency. The codons (or AA) of interest are those with a high/low odds ratio and high frequency.
}


\examples{
# If only the anota2seq object
codonOut <- codonUsage(annotType = "ccds", sourceSeq = "load", species = "human", analysis = "codon", codonN = 1, type = "sequence", pAdj = 0.01 , plotHeatmap = TRUE, ads = anota2seqOutput, regulation = c("translationUp","translationDown"), contrast = contrast = c(1,1), selection = "random", comparisons = list(c(0,1),c(0,2),c(1,2)))

# If only the geneList
codonOut <- codonUsage(annotType = "ccds", sourceSeq = "load", species = "human", analysis = "codon", codonN = 1, type = "sequence", pAdj = 0.01 , plotHeatmap = TRUE, geneList = inList,  selection = "random", comparisons = list(c(0,1),c(0,2),c(1,2)))

### For ribosomal profiling
#It is important that the annotation is the same as the one used for alignement. Optionally, it can be provided if different to the one in the package
annot <- retrieveFormatData(source='load', species='human')

dpn_files <- c(cond1_rep1.dpn, cond1_rep2.dpn, cond1_rep3.dpn,cond2_rep1.dpn, cond2_rep2.dpn, cond2_rep3.dpn)
condition <- c(1,1,1,2,2,2)
inputTable <- data.frame(dpnFiles=dpn_files, condition=condition,stringsAsFactors=FALSE)

codonOut <- codonUsage(type = "riboseq", annot=annot, dpn_path = '.', analysis = "codon", codonN = 1, pAdj = 0.01 , plotHeatmap = TRUE, ads = anota2seqOutput, regulation = c("translationUp","translationDown"), contrast = contrast = c(1,1), selection = "random", comparisons = list(c(0,1),c(0,2),c(1,2)), inputTable = inputTable)
}