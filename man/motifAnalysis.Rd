% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/motifAnalysis.R
\name{motifAnalysis}
\alias{motifAnalysis}
\title{ De-novo motif discovery using STREME }

\usage{
motifAnalysis(annot, stremeThreshold = 0.05, minwidth=6, memePath=NULL, seqType='dna', ads = NULL, regulation = NULL, contrast = NULL, geneList = NULL, customBg = NULL, selection = "random", region, subregion=NULL, subregionSel=NULL )
}

\arguments{
\item{annot}{ An object containing reference sequences is obtained by the retrieveFormatData function. It is data.frame in format: id, geneID, UTR5_seq, CDS_seq, UTR3_seq }
\item{stremeThreshold}{ p-value threshold for motif selection. The default is 0.05 }
\item{minwidth}{ minimal width if the motif. The default is 6. }
\item{memePath}{ path to the stream executables }
\item{seqType}{ Sequence type of the motif. Choose from dna, rna, or protein. The default is "dna". }
\item{ads}{ An anota2seq object (an output of anota2seqRun function from anota2seq package) }
\item{regulation}{ If the anota2seq object is provided, desired names of regulation modes from the anota2seq object to be analysed. To choose combination from "translationUp", "translationDown", "translatedmRNAUp", "translatedmRNAUp", "bufferingmRNAUp", "bufferingmRNADown", "mRNAAbundanceUp", "mRNAAbundanceDown", "totalmRNAUp", "totalmRNADown". }
\item{contrast}{ If the anota2seq object is provided and regulation modes selected, an indication of respective contrasts in the anota2seq object for each selected regulation mode (for example c(1,1,2) would indicate that the first two modes of regulation provided above are from contrast 1 and the third one from contrast 2). }
\item{geneList}{ Instead of the anota2seq object, selected genes of interest can be provided in form of a named list of vectors. }
\item{customBg}{ There is an option to provide a custom set of background genes as a character vector. }
\item{selection}{ There are multiple isoforms for a given gene, In this option, it is decided which isoform is selected to represent the gene, whether the longest or the shortest for a given region will be taken into consideration or simply random one.  Choose from  "longest", "shortest", or "random". The default is "random". }
\item{region}{ Select the regions of interest. Choose from combination of "UTR5", "CDS", "UTR3" }
\item{subregion}{ Optionally it is possible to select a subregion by indicating a number of nucleotides from the start if positive or end if negative. }
\item{subregionSel}{ It is required if the subregion is provided. Choose whether the indicated subregion should be "select" or "exclude". }
}

\value{
For each selected region, the list of motifs that passed the selected threshold. All the outputs for each regulatory mode are also appended.
}

\description{
The function applies the stream method to discover de-novo ungapped motifs (recurring, fixed-length patterns) that are enriched in the sequences in the regulatory mode provided against control sequences. 
}

\details{
Properly setting the control sequences is key to discovering biologically relevant motifs, therefore it is required to have them in order to run the function.

# Citation
If you use "runStreme()" in your analysis, please cite:
Timothy L. Bailey, "STREME: Accurate and versatile sequence motif discovery", Bioinformatics, 2021. https://doi.org/10.1093/bioinformatics/btab203

# Licensing The MEME Suite is free for non-profit use, but for-profit users should purchase a license. See the [MEME Suite Copyright Page](http://meme-suite.org/doc/copyright.html) for details.
}

\examples{
# Check available versions
checkAvailableVersions(species = "human")
# Load pre-existing reference sequences
annot <- retrieveFormatData(source="load", version="rel_109.20201120",species = "human")

# If only the anota2seq object
denovo_motifs <- motifAnalysis(annot = annot, stremeThreshold = 0.05, minwidth=6, memePath="/opt/local/bin", seqType='dna', ads = anota2seqOutput, regulation = c("translationUp","translationDown"), contrast = c(1,1), selection = "random", region = c("UTR5","CDS","UTR3"))

# If only the geneList
denovo_motifs <- motifAnalysis(annot = annot, stremeThreshold = 0.05, minwidth=6, memePath="/opt/local/bin", seqType='dna', geneList = inList, selection = "random", region = c("UTR5","CDS","UTR3"))
}